<odoo>
  <!-- Vista inicial al entrar a la app -->
  <record id="view_app_quote_tree" model="ir.ui.view">
    <field name="name">app.quote.tree</field>
    <field name="model">app.quote</field>
    <field name="arch" type="xml">
      <tree string="Cotizaciones" default_order="date_order desc">
        <field name="name" string="Folio"/>
        <field name="date_order"/>
        <field name="partner_id"/>
        <field name="user_id"/>
        <field name="company"/>
        <field name="state"/>
      </tree>
    </field>
  </record>

  <!-- Busqueda -->
  <record id="view_app_quote_search" model="ir.ui.view">
    <field name="name">app.quote.search</field>
    <field name="model">app.quote</field>
    <field name="arch" type="xml">
      <search string="Buscar cotizaciones">
        <field name="name" string="Folio"/>
        <field name="partner_id" string="Cliente"/>
        <field name="user_id" string="Vendedor"/>
        <filter name="state_draft" string="Borrador" domain="[('state','=','draft')]"/>
        <filter name="state_sent" string="Enviada" domain="[('state','=','sent')]"/>
        <filter name="state_confirmed" string="Confirmada" domain="[('state','=','confirmed')]"/>
        <filter name="state_cancel" string="Cancelada" domain="[('state','=','cancel')]"/>
        <group expand="0" string="Agrupar por">
          <filter string="Vendedor" name="grp_user" context="{'group_by':'user_id'}"/>
          <filter string="Estado" name="grp_state" context="{'group_by':'state'}"/>
          <filter string="Fecha" name="grp_date" context="{'group_by':'date_order'}"/>
        </group>
      </search>
    </field>
  </record>

  <!-- Formulario -->
  <record id="view_app_quote_form" model="ir.ui.view">
    <field name="name">app.quote.form</field>
    <field name="model">app.quote</field>
    <field name="arch" type="xml">
      <form string="Cotización" class="o_sale_order">
        <!--Aquí es la barra de estado de las contizaciones y los botones-->
        <header>
          <!--Botón destacado, solo es visible en borrador y enviado-->
          <button name="action_confirm"
                  type="object"
                  string="Confirmar"
                  class="btn-primary"
                  attrs="{'invisible': [('state','not in', ('draft','sent'))]}"
                  confirm="¿estás seguro de confirmar la contización?"/>

          <!--Boton para cancelar-->
          <button name="action_cancel"
                  type="object"
                  string="Cancelar"
                  class="btn-secondary"
                  attrs="{'invisible': [('state','not in', ('draft','sent','confirmed'))]}"/>

          <!--Boton para volver a borrador-->
          <button name="action_set_draft"
          type="object"
          string="Establecer como borrador"
          attrs="{'invisible': [('state','!=','cancel')]}"/>

          <!--Barra de estado-->
          <field name="state" widget="statusbar" statusbar_visible="draft,sent,confirmed,cancel" readonly="1"/>
        </header>

        <sheet>
          <!--Titulo -->
          <div>
            <h1>
              <field name="name" readonly="1" required="1" string="Folio"/>
            </h1>
          </div>

          <!--Encabezados de dos columnas-->
          <group>
            <group>
              <field name="partner_id"
                     domain="[('active','=', True)]"
                     context="{'res_partner_search_mode': 'customer', 'show_address': 1, 'show_email': 1}"
                     options="{'no_open': False, 'no_create_edit': False}"/>/>

              <field name="user_id" string="Vendedor" attrs="{'invisible': [('state', '!=', 'confirmed')],
                     'readonly': [('state','in',('confirmed','cancel'))]}"/>
            </group>

            <group name="order_details">
              <field name="date_order" string="Fecha de cotización" attrs="{'readonly': [('state','in',('confirmed','cancel'))]}"/>
              <field name="company" string="Compañía" attrs="{'invisible': [('state', '!=', 'confirmed')],
                     'readonly': [('state','in',('confirmed','cancel'))]}"/>
            </group>
          </group>
          <!-- Estructura visual de ventas-->
          <notebook attrs="{'invisible': [('partner_id', '=', False)]}">
            <page string="Caracteristicas del equipo">
              <group>
                <group>
                  <field name="elevator_quant"/>
                  <field name="group_elevator"/>
                  <field name="capacity_elevator"/>
                  <field name="entrance_type"/>
                  <field name="door_height"/>
                  <field name="door_type"/>
                </group>
                <group>
                  <field name="door_width"/>
                  <field name="type_install"/>
                  <field name="car_door"/>
                  <field name="landing_door"/>
                  <field name="car_model"/>
                  <field name="car_floor"/>
                </group>
              </group>
            </page>

            <page string="Información sobre los elevadores">
              <group>
                <separator string="Aquí irán los campos requeridos para los elevadores" colspan="2"/>
              </group>
            </page>
          </notebook>
        </sheet>
      </form>
    </field>
  </record>





  <!-- Action -->
  <record id="action_my_app_items" model="ir.actions.act_window">
    <field name="name">Cotizaciones</field>
    <field name="res_model">app.quote</field>
    <field name="view_mode">tree,form</field>
    <field name="view_id" ref="view_app_quote_tree"/>
    <field name="search_view_id" ref="view_app_quote_search"/>
  </record>
</odoo>
